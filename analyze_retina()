from PIL import Image

def analyze_retina(image_path):
    try:
        image = Image.open(image_path).convert("RGB")
    except Exception:
        raise ValueError("Uploaded image is corrupted or unreadable.")
log_scan_to_supabase(
    image_name=image.filename,
    confidence=result["confidence"],
    severity=result["severity"],
    gradcam_url=result["gradcam_url"]
)
